syntax = "proto3";

package insightify.v1;

option go_package = "insightifyv1";

// UserInteractionService manages user/server message interaction for a run.
service UserInteractionService {
  rpc Wait(WaitRequest) returns (WaitResponse);
  rpc Send(SendRequest) returns (SendResponse);
  rpc Close(CloseRequest) returns (CloseResponse);
}

message WaitRequest {
  string run_id = 1;
  int32 timeout_ms = 2;
}

message WaitResponse {
  bool waiting = 1;
  string interaction_id = 2;
  bool closed = 3;
}

message SendRequest {
  string run_id = 1;
  string interaction_id = 2;
  string input = 3;
}

message SendResponse {
  bool accepted = 1;
  string interaction_id = 2;
  string assistant_message = 3;
}

message CloseRequest {
  string run_id = 1;
  string interaction_id = 2;
  string reason = 3;
}

message CloseResponse {
  bool closed = 1;
}
