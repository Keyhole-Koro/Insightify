syntax = "proto3";

package pipeline.v1;

import "pipeline/v1/client_view.proto";
import "pipeline/v1/progress.proto";

// Run a set of phases and stream progress + phase results.
service GatewayService {
  rpc RunPipeline(RunPipelineRequest) returns (stream RunPipelineResponse);
}

message RunPipelineRequest {
  string repo_name = 1;
  repeated string phase_keys = 3; // e.g. ["m0","m1","m2"]
}

message RunPipelineResponse {
  oneof event {
    ProgressEvent progress = 1;
    ClientView client_view = 2;
  }
}
